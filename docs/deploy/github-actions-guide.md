# üöÄ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é —á–µ—Ä–µ–∑ GitHub Actions

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 9 —Å–µ–Ω—Ç—è–±—Ä—è 2025–≥.  
**–ê–≤—Ç–æ—Ä:** Claude Code  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–µ–ø–ª–æ—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π VPS —Å–µ—Ä–≤–µ—Ä** —á–µ—Ä–µ–∑ GitHub Actions –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main`. –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –∏ –≤–∫–ª—é—á–∞–µ—Ç:

- ‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è –∏ –ª–∏–Ω—Ç–∏–Ω–≥** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞** - build Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Socket.io
- ‚úÖ **–î–µ–ø–ª–æ–π –Ω–∞ VPS** - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ SSH —Å PM2
- ‚úÖ **Health Check** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- ‚úÖ **Backup —Å–∏—Å—Ç–µ–º–∞** - –∞–≤—Ç–æ–±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–µ–ø–ª–æ—è

### –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Git Push      ‚îÇ    ‚îÇ  GitHub Actions ‚îÇ    ‚îÇ   Production    ‚îÇ
‚îÇ   to main       ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ     Runner      ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   VPS Server    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                        ‚îÇ                        ‚îÇ
         ‚îÇ                        ‚îÇ                        ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Commit  ‚îÇ              ‚îÇ Build   ‚îÇ              ‚îÇ PM2 +   ‚îÇ
    ‚îÇ Changes ‚îÇ              ‚îÇ Test    ‚îÇ              ‚îÇ Nginx   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ Package ‚îÇ              ‚îÇ Process ‚îÇ
                             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

1. **GitHub Actions Workflow** - `.github/workflows/deploy.yml`
2. **PM2 Configuration** - `ecosystem.config.cjs`
3. **Health Check API** - `src/app/api/health/route.ts`
4. **Environment Secrets** - GitHub Repository Settings
5. **Server Setup** - VPS —Å Nginx + PM2 + Bun

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–µ–ø–ª–æ—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ deploy.yml              # –ì–ª–∞–≤–Ω—ã–π workflow —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ ecosystem.config.cjs        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PM2
‚îú‚îÄ‚îÄ src/app/api/health/
‚îÇ   ‚îî‚îÄ‚îÄ route.ts               # Health check endpoint
‚îú‚îÄ‚îÄ server.js                  # Custom server —Å Socket.io
‚îî‚îÄ‚îÄ docs/deploy/               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions

### 1. GitHub Secrets

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (Settings ‚Üí Secrets and variables ‚Üí Actions) –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

#### üîê –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–µ–ø–ª–æ—è:
```bash
DEPLOY_KEY           # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
DEPLOY_USER          # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: root)
DEPLOY_HOST          # IP –∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: kirdro.ru)
```

#### üóÑÔ∏è –°–µ–∫—Ä–µ—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
DATABASE_URL         # PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
NEXTAUTH_SECRET      # –°–µ–∫—Ä–µ—Ç –¥–ª—è NextAuth.js
NEXTAUTH_URL         # URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://kirdro.ru)
GROQ_API_KEY         # API –∫–ª—é—á –¥–ª—è –ò–ò —á–∞—Ç–∞
```

#### üìß –°–µ–∫—Ä–µ—Ç—ã –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
EMAIL_SERVER_HOST    # SMTP —Ö–æ—Å—Ç
EMAIL_SERVER_PORT    # SMTP –ø–æ—Ä—Ç (–æ–±—ã—á–Ω–æ 587)
EMAIL_SERVER_USER    # SMTP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
EMAIL_SERVER_PASSWORD # SMTP –ø–∞—Ä–æ–ª—å
EMAIL_FROM           # Email –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
```

#### üîë OAuth —Å–µ–∫—Ä–µ—Ç—ã:
```bash
AUTH_YANDEX_ID       # Yandex OAuth Client ID
AUTH_YANDEX_SECRET   # Yandex OAuth Client Secret
AUTH_SECRET          # –û–±—â–∏–π —Å–µ–∫—Ä–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
AUTH_TRUST_HOST      # –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Ö–æ—Å—Ç (true)
```

### 2. Workflow –§–∞–π–ª

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª: `.github/workflows/deploy.yml`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ workflow:**

#### –≠—Ç–∞–ø 1: TypeScript Check
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Å –ø–æ–º–æ—â—å—é `bun run typecheck`
- –õ–∏–Ω—Ç–∏–Ω–≥ —Å –ø–æ–º–æ—â—å—é `bun run lint`
- –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö –ª–∏–Ω—Ç–∞

#### –≠—Ç–∞–ø 2: Build
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Bun
- –°–±–æ—Ä–∫–∞ Next.js —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ –¥–ª—è –¥–µ–ø–ª–æ—è
- Upload –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞

#### –≠—Ç–∞–ø 3: Deploy (—Ç–æ–ª—å–∫–æ –¥–ª—è main –≤–µ—Ç–∫–∏)
- Download —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
- Backup –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2

#### –≠—Ç–∞–ø 4: Health Check
- –ü—Ä–æ–≤–µ—Ä–∫–∞ API health endpoint
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É:

#### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **OS:** Ubuntu 20.04+ / Debian 10+
- **RAM:** –º–∏–Ω–∏–º—É–º 1GB, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2GB+
- **Storage:** –º–∏–Ω–∏–º—É–º 20GB SSD
- **Network:** –ø—É–±–ª–∏—á–Ω—ã–π IP –∞–¥—Ä–µ—Å

#### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
sudo apt update && sudo apt upgrade -y
sudo apt install curl wget git nginx -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Bun
curl -fsSL https://bun.sh/install | bash
echo 'export PATH="$HOME/.bun/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2
npm install -g pm2

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo apt install postgresql postgresql-contrib -y
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx:

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∞–π—Ç–∞ (`/etc/nginx/sites-available/kirdro.ru`):
```nginx
server {
    listen 80;
    listen 443 ssl http2;
    server_name kirdro.ru www.kirdro.ru;

    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (–ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ Let's Encrypt)
    ssl_certificate /etc/letsencrypt/live/kirdro.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/kirdro.ru/privkey.pem;

    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    location / {
        proxy_pass http://localhost:3003;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # WebSocket –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è Socket.io
    location /socket.io/ {
        proxy_pass http://localhost:3003;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
sudo ln -s /etc/nginx/sites-available/kirdro.ru /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π:

#### –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–∞:
```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
ssh-keygen -t rsa -b 4096 -C "deploy@github-actions"

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id user@your-server.com

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ GitHub Secrets –∫–∞–∫ DEPLOY_KEY
```

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫:
```bash
# –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
sudo mkdir -p /var/www/kirdro.ru
sudo chown -R $USER:$USER /var/www/kirdro.ru

# –õ–æ–≥–∏
sudo mkdir -p /var/log/kirdro
sudo chown -R $USER:$USER /var/log/kirdro

# PM2 –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
pm2 startup
sudo env PATH=$PATH:$HOME/.bun/bin pm2 startup systemd -u $USER --hp $HOME
```

---

## üìã PM2 Configuration

### –§–∞–π–ª: `ecosystem.config.cjs`

```javascript
module.exports = {
  apps: [{
    name: 'kirdro-portfolio',           // –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
    script: 'bun',                     // –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Bun
    args: 'start',                     // –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ (bun start)
    cwd: '/var/www/kirdro.ru',         // –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    instances: 1,                      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
    exec_mode: 'fork',                 // –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    env_file: '.env',                  // –§–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    env: {
      NODE_ENV: 'production',
      PORT: 3003,                      // –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    },
    env_production: {
      NODE_ENV: 'production',
      PORT: 3003,
    },
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    error_file: '/var/log/kirdro/error.log',
    out_file: '/var/log/kirdro/access.log',
    log_file: '/var/log/kirdro/app.log',
    time: true,
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
    watch: false,                      // –ù–µ —Å–ª–µ–¥–∏–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ñ–∞–π–ª–æ–≤
    min_uptime: '10s',                 // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
    max_restarts: 10,                  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤
    max_memory_restart: '1G',          // –†–µ—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏
    
    // Health monitoring
    health_check_url: 'http://localhost:3003/api/health',
    health_check_grace_period: 3000,
  }]
};
```

### PM2 –∫–æ–º–∞–Ω–¥—ã:

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 start ecosystem.config.cjs

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 status
pm2 logs kirdro-portfolio
pm2 monit

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
pm2 reload kirdro-portfolio    # Graceful reload
pm2 restart kirdro-portfolio   # Hard restart
pm2 stop kirdro-portfolio      # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 delete kirdro-portfolio    # –£–¥–∞–ª–µ–Ω–∏–µ

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
pm2 save
pm2 resurrect                  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
```

---

## ü©∫ Health Check System

### API Endpoint: `/api/health`

**–§–∞–π–ª:** `src/app/api/health/route.ts`

```typescript
import { NextResponse } from 'next/server';
import { db } from '~/server/db';

export async function GET() {
  try {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    await db.$queryRaw`SELECT 1`;
    
    return NextResponse.json({
      status: 'healthy',
      timestamp: new Date().toISOString(),
      uptime: process.uptime(),
      memory: process.memoryUsage(),
      env: process.env.NODE_ENV,
    });
  } catch (error) {
    return NextResponse.json(
      {
        status: 'unhealthy',
        timestamp: new Date().toISOString(),
        error: 'Database connection failed',
      },
      { status: 503 }
    );
  }
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ workflow:

1. **API Health Check** - `https://kirdro.ru/api/health` (HTTP 200)
2. **Main Page Check** - `https://kirdro.ru/` (HTTP 200)
3. **Content Validation** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Hello World!"
4. **Server Diagnostics** - –ª–æ–≥–∏, –ø—Ä–æ—Ü–µ—Å—Å—ã, –ø–æ—Ä—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π:

1. **Push –≤ main –≤–µ—Ç–∫—É** ‚Üí —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç workflow
2. **TypeScript + Lint** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
3. **Build Process** ‚Üí —Å–±–æ—Ä–∫–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. **Package Creation** ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ —Å build —Ñ–∞–π–ª–∞–º–∏
5. **SSH Deploy** ‚Üí –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
6. **PM2 Reload** ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞
7. **Health Check** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
8. **Notifications** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. Backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
sudo cp -r /var/www/kirdro.ru /var/www/kirdro.ru.backup.$(date +%Y%m%d_%H%M%S)

# 2. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
cd /var/www/kirdro.ru
rm -rf * .* 2>/dev/null || true

# 3. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞
tar -xzf /tmp/kirdro-deploy.tar.gz

# 4. –°–æ–∑–¥–∞–Ω–∏–µ .env —Å –ø—Ä–æ–¥–∞–∫—à–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
tee .env > /dev/null <<EOF
DATABASE_URL="postgresql://..."
NEXTAUTH_SECRET="..."
# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
NODE_ENV=production
PORT=3003
EOF

# 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
bun install --production

# 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤
chown -R www-data:www-data /var/www/kirdro.ru
chmod 600 .env

# 7. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2
pm2 reload kirdro-portfolio || pm2 start ecosystem.config.cjs

# 8. Cleanup
rm -f /tmp/kirdro-deploy.tar.gz
```

---

## üîß –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –¥—Ä—É–≥–æ–π –ø—Ä–æ–µ–∫—Ç

### –®–∞–≥ 1: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
# GitHub Actions workflow
.github/workflows/deploy.yml

# PM2 configuration
ecosystem.config.cjs

# Health check endpoint
src/app/api/health/route.ts
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ workflow —Ñ–∞–π–ª–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `.github/workflows/deploy.yml`:**

```yaml
# –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
name: üöÄ Deploy Your Project Name

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ env —Å–µ–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 66-78)
env:
  DATABASE_URL: ${{ secrets.DATABASE_URL }}
  NEXTAUTH_SECRET: ${{ secrets.NEXTAUTH_SECRET }}
  NEXTAUTH_URL: ${{ secrets.NEXTAUTH_URL }}
  # ... –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# –ò–∑–º–µ–Ω–∏—Ç–µ –¥–æ–º–µ–Ω –∏ –ø—É—Ç–∏ (—Å—Ç—Ä–æ–∫–∏ 190-206)
DATABASE_URL="${{ secrets.DATABASE_URL }}"
NEXTAUTH_URL="https://your-domain.com"  # ‚Üê –∏–∑–º–µ–Ω–∏—Ç–µ –¥–æ–º–µ–Ω
NODE_ENV=production
PORT=3003  # ‚Üê –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

# –û–±–Ω–æ–≤–∏—Ç–µ health check URL (—Å—Ç—Ä–æ–∫–∏ 240, 257)
https://your-domain.com/api/health  # ‚Üê –≤–∞—à –¥–æ–º–µ–Ω
https://your-domain.com/           # ‚Üê –≤–∞—à –¥–æ–º–µ–Ω
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PM2

**–û–±–Ω–æ–≤–∏—Ç–µ `ecosystem.config.cjs`:**

```javascript
module.exports = {
  apps: [{
    name: 'your-project-name',        // ‚Üê –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    script: 'bun',                   // –∏–ª–∏ 'npm' –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ npm
    args: 'start',
    cwd: '/var/www/your-domain.com', // ‚Üê –ø—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    instances: 1,
    exec_mode: 'fork',
    env_file: '.env',
    env: {
      NODE_ENV: 'production',
      PORT: 3003,                    // ‚Üê –≤–∞—à –ø–æ—Ä—Ç
    },
    
    // –û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç–∏ –∫ –ª–æ–≥–∞–º
    error_file: '/var/log/your-project/error.log',
    out_file: '/var/log/your-project/access.log', 
    log_file: '/var/log/your-project/app.log',
    time: true,
    
    // Health check URL
    health_check_url: 'http://localhost:3003/api/health',
    health_check_grace_period: 3000,
  }]
};
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

**–î–æ–±–∞–≤—å—Ç–µ –≤ Settings ‚Üí Secrets and variables ‚Üí Actions:**

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–µ–ø–ª–æ—è:
```bash
DEPLOY_KEY=      # SSH –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
DEPLOY_USER=     # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
DEPLOY_HOST=     # IP –∏–ª–∏ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞
```

#### –°–µ–∫—Ä–µ—Ç—ã –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
DATABASE_URL=    # —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
NEXTAUTH_SECRET= # —Å–µ–∫—Ä–µ—Ç –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
NEXTAUTH_URL=    # URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞
# ... –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

### –®–∞–≥ 5: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
sudo mkdir -p /var/www/your-domain.com
sudo mkdir -p /var/log/your-project
sudo chown -R $USER:$USER /var/www/your-domain.com
sudo chown -R $USER:$USER /var/log/your-project

# Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
sudo nano /etc/nginx/sites-available/your-domain.com
```

**Nginx config –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞:**
```nginx
server {
    listen 80;
    listen 443 ssl http2;
    server_name your-domain.com www.your-domain.com;

    # SSL certificates  
    ssl_certificate /path/to/your/cert.pem;
    ssl_certificate_key /path/to/your/key.pem;

    location / {
        proxy_pass http://localhost:3003;  # ‚Üê –≤–∞—à –ø–æ—Ä—Ç
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### –®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –¥–æ—Å—Ç—É–ø–∞
ssh your-user@your-server.com

# 2. –¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–º–∏—Ç
git add .
git commit -m "Test deploy setup"  
git push origin main

# 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ workflow
# –ò–¥–∏—Ç–µ –≤ GitHub ‚Üí Actions –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
pm2 status
curl http://localhost:3003/api/health
curl https://your-domain.com/api/health
```

---

## üõ†Ô∏è Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

#### 1. SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –∫–ª—é—á–∞
ssh -T git@github.com

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh -o StrictHostKeyChecking=no user@server

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ GitHub Secrets
# –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å -----BEGIN OPENSSH PRIVATE KEY-----
```

#### 2. Build –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π –ø–∞–º—è—Ç–∏
```yaml
# –í workflow —Ñ–∞–π–ª–µ –¥–æ–±–∞–≤—å—Ç–µ:
- name: üèó Build Next.js
  run: NODE_OPTIONS="--max_old_space_size=4096" bun run build
```

#### 3. PM2 –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
pm2 list
pm2 describe your-app-name
pm2 logs your-app-name

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω—É–ª—è
pm2 delete your-app-name
pm2 start ecosystem.config.cjs
```

#### 4. Health check –ø–∞–¥–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint
curl -v http://localhost:3003/api/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
pm2 logs your-app-name
tail -f /var/log/your-project/error.log
```

#### 5. Nginx –Ω–µ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
sudo systemctl reload nginx

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/error.log
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ps aux | grep -E "(bun|next|node)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤  
netstat -tlnp | grep :3003
ss -tlnp | grep :3003

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
df -h
du -sh /var/www/your-domain.com

# –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
htop
free -m
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### PM2 Dashboard:
```bash
# –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å PM2
pm2 web

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 monit

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
pm2 show kirdro-portfolio
```

### –õ–æ–≥–∏:
```bash
# PM2 –ª–æ–≥–∏
pm2 logs kirdro-portfolio
pm2 logs kirdro-portfolio --lines 100

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
tail -f /var/log/kirdro/app.log
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log

# GitHub Actions –ª–æ–≥–∏
# –î–æ—Å—Ç—É–ø–Ω—ã –≤ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ GitHub ‚Üí Actions ‚Üí Workflow run
```

### –ú–µ—Ç—Ä–∏–∫–∏:
- **Health Check API** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- **PM2 Status** - —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ —Ä–µ—Å—É—Ä—Å—ã
- **Nginx Logs** - —Ç—Ä–∞—Ñ–∏–∫ –∏ –æ—à–∏–±–∫–∏
- **System Metrics** - CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

#### SSH Security:
```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è SSH (—Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏)
sudo nano /etc/ssh/sshd_config
# PasswordAuthentication no
# PubkeyAuthentication yes

sudo systemctl restart sshd
```

#### Firewall:
```bash
# UFW –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
sudo ufw enable
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP  
sudo ufw allow 443/tcp  # HTTPS
sudo ufw deny 3003/tcp  # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
```

#### Environment Variables:
- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ Git
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Secrets –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –§–∞–π–ª .env –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ .gitignore
- ‚úÖ –ü—Ä–∞–≤–∞ –Ω–∞ .env —Ñ–∞–π–ª: 600 (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü —á–∏—Ç–∞–µ—Ç)

#### SSL/HTTPS:
```bash
# Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com -d www.your-domain.com
sudo certbot renew --dry-run  # —Ç–µ—Å—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

---

## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Build –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

#### Next.js config (`next.config.js`):
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
  swcMinify: true,
  compress: true,
  
  // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
  trailingSlash: false,
  poweredByHeader: false,
  
  // –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  experimental: {
    optimizeCss: true,
    optimizeServerReact: true,
  },
  
  // Bundle analyzer
  webpack: (config, { dev, isServer }) => {
    if (!dev && !isServer) {
      const { BundleAnalyzerPlugin } = require('webpack-bundle-analyzer');
      config.plugins.push(
        new BundleAnalyzerPlugin({
          analyzerMode: 'disabled',
          generateStatsFile: true,
        })
      );
    }
    return config;
  },
};
```

### PM2 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

#### Cluster mode (–¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π):
```javascript
module.exports = {
  apps: [{
    name: 'your-app',
    script: 'bun',
    args: 'start',
    instances: 'max',           // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ CPU —è–¥—Ä–∞
    exec_mode: 'cluster',       // –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π —Ä–µ–∂–∏–º
    max_memory_restart: '500M', // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ 500MB
    node_args: '--max-old-space-size=1024',
    
    // Graceful reload
    kill_timeout: 5000,
    wait_ready: true,
    listen_timeout: 10000,
  }]
};
```

### Nginx –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```nginx
server {
    # Gzip —Å–∂–∞—Ç–∏–µ
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript;
    
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # Rate limiting
    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
    
    location /api/ {
        limit_req zone=api burst=20 nodelay;
        proxy_pass http://localhost:3003;
    }
}
```

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- ‚úÖ **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –æ—Ç –∫–æ–º–º–∏—Ç–∞ –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω–∞
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - SSH –∫–ª—é—á–∏, —Å–µ–∫—Ä–µ—Ç—ã, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - backup, health checks, graceful reload
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ª–æ–≥–∏, –º–µ—Ç—Ä–∏–∫–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - PM2 cluster, Nginx load balancing
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∑–∞–Ω–∏–º–∞–µ—Ç ~30 –º–∏–Ω—É—Ç** –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ–∫—Ä–µ—Ç–æ–≤.

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Claude Code*  
*–í–µ—Ä—Å–∏—è: 1.0 | –î–∞—Ç–∞: 9 —Å–µ–Ω—Ç—è–±—Ä—è 2025–≥.*